{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/app/projects/%5Bid%5D/edit/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { useApi } from \"../../../context/ApiContext\";\r\n\r\nconst spaceTypes = [\"Apartment\", \"Villa\", \"Studio\", \"Office\", \"Duplex\"];\r\nconst finishStyles = [\"Modern\", \"Classic\", \"Minimalist\", \"Industrial\", \"Bohemian\"];\r\nconst qualityLevels = [\"High Quality\", \"Medium Quality\", \"Economy Quality\"];\r\n\r\ntype Service = { id: number; name: string };\r\n\r\nexport default function EditProjectPage() {\r\n  const { baseUrl } = useApi();\r\n  const { id } = useParams();\r\n  const router = useRouter();\r\n\r\n  const [step, setStep] = useState(1);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [services, setServices] = useState<Service[]>([]);\r\n\r\n  const [formData, setFormData] = useState({\r\n    name: \"\",\r\n    serviceId: \"\",\r\n    apartmentType: \"\",\r\n    apartmentSize: \"\",\r\n    preferredStyle: \"\",\r\n    materialQuality: \"\",\r\n    minBudget: \"\",\r\n    maxBudget: \"\",\r\n    details: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const token = localStorage.getItem(\"token\");\r\n\r\n        // تحميل بيانات المشروع\r\n        const res = await fetch(`${baseUrl}/api/Projects/${id}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        const text = await res.text();\r\n        if (!text) throw new Error(\"Empty response from project API\");\r\n        const data = JSON.parse(text);\r\n\r\n        setFormData({\r\n          name: data.name ?? \"\",\r\n          serviceId: data.serviceId?.toString() ?? \"\",\r\n          apartmentType: data.apartmentType ?? \"\",\r\n          apartmentSize: data.apartmentSize ?? \"\",\r\n          preferredStyle: data.preferredStyle ?? \"\",\r\n          materialQuality: data.materialQuality ?? \"\",\r\n          minBudget: data.minBudget?.toString() ?? \"\",\r\n          maxBudget: data.maxBudget?.toString() ?? \"\",\r\n          details: data.details ?? \"\",\r\n        });\r\n\r\n        // تحميل الخدمات\r\n        const catRes = await fetch(`${baseUrl}/api/Categories`);\r\n        const catJson = await catRes.json();\r\n        const extractedServices = (catJson?.data || []).flatMap((category: any) =>\r\n          (category.services || []).map((s: any) => ({\r\n            id: s.id,\r\n            name: s.name,\r\n          }))\r\n        );\r\n        setServices(extractedServices);\r\n      } catch (err: any) {\r\n        setError(err.message || \"Something went wrong.\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [baseUrl, id]);\r\n\r\n  const handleChange = (e: any) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n\r\n      const res = await fetch(`${baseUrl}/api/Projects/${id}`, {\r\n        method: \"PUT\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({\r\n          ...formData,\r\n          serviceId: parseInt(formData.serviceId),\r\n          minBudget: parseInt(formData.minBudget),\r\n          maxBudget: parseInt(formData.maxBudget),\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(errorText || \"Failed to update project\");\r\n      }\r\n\r\n      alert(\"Project updated successfully!\");\r\n      router.push(`/projects/${id}`);\r\n    } catch (err: any) {\r\n      alert(\"Error: \" + err.message);\r\n    }\r\n  };\r\n\r\n  if (loading) return <p className=\"text-center mt-10\">Loading...</p>;\r\n  if (error) return <p className=\"text-center mt-10 text-red-600\">{error}</p>;\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-xl mx-auto bg-white shadow rounded-xl\">\r\n      <h1 className=\"text-xl font-bold mb-4\">Edit Project</h1>\r\n\r\n      {/* الخطوة الأولى */}\r\n      {step === 1 && (\r\n        <div className=\"space-y-4\">\r\n          <input\r\n            type=\"text\"\r\n            name=\"name\"\r\n            value={formData.name}\r\n            onChange={handleChange}\r\n            placeholder=\"Project Name\"\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          />\r\n          <select\r\n            name=\"serviceId\"\r\n            value={formData.serviceId || \"\"}\r\n            onChange={handleChange}\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          >\r\n            <option value=\"\">Select Service</option>\r\n            {services.map((s) => (\r\n              <option key={s.id} value={s.id}>\r\n                {s.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <select\r\n            name=\"apartmentType\"\r\n            value={formData.apartmentType || \"\"}\r\n            onChange={handleChange}\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          >\r\n            <option value=\"\">Select Apartment Type</option>\r\n            {spaceTypes.map((t) => (\r\n              <option key={t} value={t}>\r\n                {t}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <input\r\n            type=\"text\"\r\n            name=\"apartmentSize\"\r\n            value={formData.apartmentSize}\r\n            onChange={handleChange}\r\n            placeholder=\"Apartment Size\"\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          />\r\n          <button\r\n            onClick={() => setStep(2)}\r\n            className=\"bg-blue-600 text-white px-4 py-2 rounded\"\r\n          >\r\n            Next\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* الخطوة الثانية */}\r\n      {step === 2 && (\r\n        <div className=\"space-y-4\">\r\n          <select\r\n            name=\"preferredStyle\"\r\n            value={formData.preferredStyle || \"\"}\r\n            onChange={handleChange}\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          >\r\n            <option value=\"\">Select Style</option>\r\n            {finishStyles.map((style) => (\r\n              <option key={style} value={style}>\r\n                {style}\r\n              </option>\r\n            ))}\r\n          </select>\r\n\r\n          <select\r\n            name=\"materialQuality\"\r\n            value={formData.materialQuality || \"\"}\r\n            onChange={handleChange}\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          >\r\n            <option value=\"\">Select Material Quality</option>\r\n            {qualityLevels.map((q) => (\r\n              <option key={q} value={q}>\r\n                {q}\r\n              </option>\r\n            ))}\r\n          </select>\r\n\r\n          <input\r\n            type=\"number\"\r\n            name=\"minBudget\"\r\n            value={formData.minBudget}\r\n            onChange={handleChange}\r\n            placeholder=\"Min Budget\"\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          />\r\n          <input\r\n            type=\"number\"\r\n            name=\"maxBudget\"\r\n            value={formData.maxBudget}\r\n            onChange={handleChange}\r\n            placeholder=\"Max Budget\"\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          />\r\n          <textarea\r\n            name=\"details\"\r\n            value={formData.details}\r\n            onChange={handleChange}\r\n            placeholder=\"Details\"\r\n            className=\"w-full border px-4 py-2 rounded\"\r\n          />\r\n          <div className=\"flex justify-between\">\r\n            <button\r\n              onClick={() => setStep(1)}\r\n              className=\"bg-gray-500 text-white px-4 py-2 rounded\"\r\n            >\r\n              Back\r\n            </button>\r\n            <button\r\n              onClick={handleSubmit}\r\n              className=\"bg-green-600 text-white px-4 py-2 rounded\"\r\n            >\r\n              Save\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 415, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 425, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}},
    {"offset": {"line": 426, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}