{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/app/context/regester/signupclient_context.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { signIn } from \"next-auth/react\"; // ← استخدمنا NextAuth\r\n\r\nconst SignUpClientContext = createContext();\r\n\r\nexport function SignUpClientProvider({ children }) {\r\n  const [error, setError] = useState(\"\");\r\n  const [cities, setCities] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [user, setUser] = useState({\r\n    name: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    confirmPassword: \"\",\r\n    phoneNumber: \"\",\r\n    address: \"\",\r\n    buildingNumber: \"\",\r\n    cityId: \"\",\r\n    age: \"\",\r\n    profilePicture: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(\"https://projectapi-ekhpcndsdgbahqhm.canadacentral-01.azurewebsites.net/api/Cities\")\r\n      .then((res) => setCities(res.data))\r\n      .catch((err) => console.error(err));\r\n  }, []);\r\n\r\n  function getUserData(e) {\r\n    const { name, value, files } = e.target;\r\n    if (name === \"profilePicture\") {\r\n      setUser((prev) => ({ ...prev, profilePicture: files[0] }));\r\n    } else {\r\n      setUser((prev) => ({ ...prev, [name]: value }));\r\n    }\r\n  }\r\n\r\n  async function sendData() {\r\n    const formData = new FormData();\r\n    formData.append(\"Name\", user.name);\r\n    formData.append(\"Email\", user.email);\r\n    formData.append(\"Password\", user.password);\r\n    formData.append(\"ConfirmPassword\", user.confirmPassword);\r\n    formData.append(\"PhoneNumber\", user.phoneNumber);\r\n    formData.append(\"Address\", user.address);\r\n    formData.append(\"BuildingNumber\", user.buildingNumber);\r\n    formData.append(\"CityId\", user.cityId);\r\n    if (user.age) formData.append(\"Age\", user.age);\r\n    if (user.profilePicture) formData.append(\"ProfilePicture\", user.profilePicture);\r\n\r\n    const { data } = await axios.post(\r\n      \"https://projectapi-ekhpcndsdgbahqhm.canadacentral-01.azurewebsites.net/api/account/register/customer\",\r\n      formData,\r\n      {\r\n        headers: { \"Content-Type\": \"multipart/form-data\" },\r\n        validateStatus: () => true,\r\n      }\r\n    );\r\n\r\n    if (!data.errors) {\r\n      setIsLoading(false);\r\n      // ← بعد النجاح، نسجل دخول مباشرة باستخدام credentials من NextAuth\r\n      await signIn(\"credentials\", {\r\n        redirect: true,\r\n        email: user.email,\r\n        password: user.password,\r\n        callbackUrl: \"/\", // ← أو الصفحة اللي تحب توديه ليها بعد التسجيل\r\n      });\r\n    } else {\r\n      setIsLoading(false);\r\n      setError(data.errors);\r\n    }\r\n  }\r\n\r\n  function submitForm(e) {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    sendData();\r\n  }\r\n\r\n  return (\r\n    <SignUpClientContext.Provider\r\n      value={{\r\n        error,\r\n        cities,\r\n        isLoading,\r\n        user,\r\n        getUserData,\r\n        submitForm,\r\n      }}\r\n    >\r\n      {children}\r\n    </SignUpClientContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useSignUpClient() {\r\n  const context = useContext(SignUpClientContext);\r\n  if (!context) {\r\n    throw new Error(\"useSignUpClient must be used within a SignUpClientProvider\");\r\n  }\r\n  return context;\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 137, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/app/context/regester/signUpWorker_context.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useSession, signIn } from \"next-auth/react\";\r\n\r\nconst SignUpIndustrialContext = createContext();\r\n\r\nexport function SignUpIndustrialProvider({ children }) {\r\n  const { data: session } = useSession();\r\n\r\n  const [error, setError] = useState(null);\r\n  const [cities, setCities] = useState([]);\r\n  const [services, setServices] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n\r\n  const [user, setUser] = useState({\r\n    displayName: '',\r\n    email: '',\r\n    password: '',\r\n    confirmPassword: '',\r\n    phoneNumber: '',\r\n    address: '',\r\n    buildingNumber: '',\r\n    cityName: '',\r\n    age: '',\r\n    profilePictureUrl: '',\r\n    serviceName: '',\r\n    description: '',\r\n    minPrice: '',\r\n    maxPrice: '',\r\n    availableDays: [],\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const [citiesRes, servicesRes] = await Promise.all([\r\n          axios.get(\"https://projectapi-ekhpcndsdgbahqhm.canadacentral-01.azurewebsites.net/api/Cities\"),\r\n          axios.get(\"https://projectapi-ekhpcndsdgbahqhm.canadacentral-01.azurewebsites.net/api/categories/services\")\r\n        ]);\r\n\r\n        setCities(citiesRes.data.data || citiesRes.data);\r\n        setServices(servicesRes.data.data || servicesRes.data);\r\n      } catch (err) {\r\n        console.error(\"Failed to fetch data:\", err);\r\n        setError(\"Failed to load required data. Please refresh the page.\");\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  function getUserData(e) {\r\n    const { name, value } = e.target;\r\n    setUser(prev => ({ ...prev, [name]: value ?? '' }));\r\n  }\r\n\r\n  function handleFileChange(e) {\r\n    const file = e.target.files[0];\r\n    setSelectedFile(file);\r\n  }\r\n\r\n  function addAvailableDay() {\r\n    setUser(prev => ({\r\n      ...prev,\r\n      availableDays: [...prev.availableDays, { day: '', startTime: '', endTime: '' }]\r\n    }));\r\n  }\r\n\r\n  function updateAvailableDay(index, field, value) {\r\n    const updated = [...user.availableDays];\r\n    updated[index][field] = value;\r\n    setUser(prev => ({ ...prev, availableDays: updated }));\r\n  }\r\n\r\n  function removeAvailableDay(index) {\r\n    const updated = user.availableDays.filter((_, i) => i !== index);\r\n    setUser(prev => ({ ...prev, availableDays: updated }));\r\n  }\r\n\r\n  async function sendData() {\r\n    const formData = new FormData();\r\n\r\n    for (const key in user) {\r\n      if (key === \"availableDays\") {\r\n        formData.append(\"availableDays\", JSON.stringify(user.availableDays));\r\n      } else {\r\n        formData.append(key, user[key] ?? '');\r\n      }\r\n    }\r\n\r\n    if (selectedFile) {\r\n      formData.append(\"profilePicture\", selectedFile);\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const res = await axios.post(\r\n        \"https://projectapi-ekhpcndsdgbahqhm.canadacentral-01.azurewebsites.net/api/account/register/worker\",\r\n        formData,\r\n        {\r\n          headers: { \"Content-Type\": \"multipart/form-data\" },\r\n          validateStatus: () => true\r\n        }\r\n      );\r\n\r\n      if (res.data.errors == null) {\r\n        await signIn(\"credentials\", {\r\n          redirect: true,\r\n          email: user.email,\r\n          password: user.password,\r\n          callbackUrl: \"/\"\r\n        });\r\n      } else {\r\n        setError(res.data.errors);\r\n      }\r\n    } catch (err) {\r\n      setError(\"Failed to send data. Try again later.\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }\r\n\r\n  function submitForm() {\r\n    sendData();\r\n  }\r\n\r\n  return (\r\n    <SignUpIndustrialContext.Provider\r\n      value={{\r\n        error,\r\n        cities,\r\n        services,\r\n        isLoading,\r\n        user,\r\n        getUserData,\r\n        handleFileChange,\r\n        submitForm,\r\n        addAvailableDay,\r\n        updateAvailableDay,\r\n        removeAvailableDay,\r\n        setUser,\r\n        clearError: () => setError(null)\r\n      }}\r\n    >\r\n      {children}\r\n    </SignUpIndustrialContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useSignUpIndustrial() {\r\n  const context = useContext(SignUpIndustrialContext);\r\n  if (!context) {\r\n    throw new Error(\"useSignUpIndustrial must be used within a SignUpIndustrialProvider\");\r\n  }\r\n  return context;\r\n}"],"names":[],"mappings":";;;;;AACA;AAEA;AADA;;;AAFA;;;;AAKA,MAAM,wCAA0B,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD;AAErC,SAAS,yBAAyB,EAAE,QAAQ,EAAE;;IACnD,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,CAAA,GAAA,iJAAA,CAAA,aAAU,AAAD;IAEnC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;QAC/B,aAAa;QACb,OAAO;QACP,UAAU;QACV,iBAAiB;QACjB,aAAa;QACb,SAAS;QACT,gBAAgB;QAChB,UAAU;QACV,KAAK;QACL,mBAAmB;QACnB,aAAa;QACb,aAAa;QACb,UAAU;QACV,UAAU;QACV,eAAe,EAAE;IACnB;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8CAAE;YACR,MAAM;gEAAY;oBAChB,IAAI;wBACF,MAAM,CAAC,WAAW,YAAY,GAAG,MAAM,QAAQ,GAAG,CAAC;4BACjD,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC;4BACV,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC;yBACX;wBAED,UAAU,UAAU,IAAI,CAAC,IAAI,IAAI,UAAU,IAAI;wBAC/C,YAAY,YAAY,IAAI,CAAC,IAAI,IAAI,YAAY,IAAI;oBACvD,EAAE,OAAO,KAAK;wBACZ,QAAQ,KAAK,CAAC,yBAAyB;wBACvC,SAAS;oBACX;gBACF;;YAEA;QACF;6CAAG,EAAE;IAEL,SAAS,YAAY,CAAC;QACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,QAAQ,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,KAAK,EAAE,SAAS;YAAG,CAAC;IACnD;IAEA,SAAS,iBAAiB,CAAC;QACzB,MAAM,OAAO,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;QAC9B,gBAAgB;IAClB;IAEA,SAAS;QACP,QAAQ,CAAA,OAAQ,CAAC;gBACf,GAAG,IAAI;gBACP,eAAe;uBAAI,KAAK,aAAa;oBAAE;wBAAE,KAAK;wBAAI,WAAW;wBAAI,SAAS;oBAAG;iBAAE;YACjF,CAAC;IACH;IAEA,SAAS,mBAAmB,KAAK,EAAE,KAAK,EAAE,KAAK;QAC7C,MAAM,UAAU;eAAI,KAAK,aAAa;SAAC;QACvC,OAAO,CAAC,MAAM,CAAC,MAAM,GAAG;QACxB,QAAQ,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,eAAe;YAAQ,CAAC;IACtD;IAEA,SAAS,mBAAmB,KAAK;QAC/B,MAAM,UAAU,KAAK,aAAa,CAAC,MAAM,CAAC,CAAC,GAAG,IAAM,MAAM;QAC1D,QAAQ,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,eAAe;YAAQ,CAAC;IACtD;IAEA,eAAe;QACb,MAAM,WAAW,IAAI;QAErB,IAAK,MAAM,OAAO,KAAM;YACtB,IAAI,QAAQ,iBAAiB;gBAC3B,SAAS,MAAM,CAAC,iBAAiB,KAAK,SAAS,CAAC,KAAK,aAAa;YACpE,OAAO;gBACL,SAAS,MAAM,CAAC,KAAK,IAAI,CAAC,IAAI,IAAI;YACpC;QACF;QAEA,IAAI,cAAc;YAChB,SAAS,MAAM,CAAC,kBAAkB;QACpC;QAEA,aAAa;QACb,IAAI;YACF,MAAM,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAC1B,sGACA,UACA;gBACE,SAAS;oBAAE,gBAAgB;gBAAsB;gBACjD,gBAAgB,IAAM;YACxB;YAGF,IAAI,IAAI,IAAI,CAAC,MAAM,IAAI,MAAM;gBAC3B,MAAM,CAAA,GAAA,iJAAA,CAAA,SAAM,AAAD,EAAE,eAAe;oBAC1B,UAAU;oBACV,OAAO,KAAK,KAAK;oBACjB,UAAU,KAAK,QAAQ;oBACvB,aAAa;gBACf;YACF,OAAO;gBACL,SAAS,IAAI,IAAI,CAAC,MAAM;YAC1B;QACF,EAAE,OAAO,KAAK;YACZ,SAAS;QACX,SAAU;YACR,aAAa;QACf;IACF;IAEA,SAAS;QACP;IACF;IAEA,qBACE,6LAAC,wBAAwB,QAAQ;QAC/B,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA,YAAY,IAAM,SAAS;QAC7B;kBAEC;;;;;;AAGP;GA9IgB;;QACY,iJAAA,CAAA,aAAU;;;KADtB;AAgJT,SAAS;;IACd,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB"}},
    {"offset": {"line": 320, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}