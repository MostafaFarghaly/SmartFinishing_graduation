{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/app/send-request/%5Bid%5D/page.tsx"],"sourcesContent":["// app/send-request/[id]/page.tsx\r\n\"use client\";\r\nimport \"@fortawesome/fontawesome-free/css/all.min.css\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport { useApi } from \"../../context/ApiContext\";\r\n\r\nexport default function SendRequestPage() {\r\n  const { id } = useParams(); // id => workerId from URL\r\n  const [projectId, setProjectId] = useState<number>(0);\r\n  const [projects, setProjects] = useState<any[]>([]);\r\n  const [response, setResponse] = useState<any>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const { baseUrl } = useApi();\r\n\r\n  // ✅ Fetch available projects\r\n  useEffect(() => {\r\n    const fetchProjects = async () => {\r\n      try {\r\n        const token = localStorage.getItem(\"token\");\r\n        const res = await fetch(`${baseUrl}/api/Projects`, {\r\n          headers: {\r\n            Authorization: token ? `Bearer ${token}` : \"\",\r\n          },\r\n        });\r\n        if (!res.ok) throw new Error(\"فشل في تحميل المشاريع\");\r\n        const data = await res.json();\r\n        setProjects(data);\r\n      } catch (err: any) {\r\n        setError(err.message || \"حدث خطأ أثناء جلب المشاريع\");\r\n      }\r\n    };\r\n\r\n    fetchProjects();\r\n  }, [baseUrl]);\r\n\r\n  // ✅ Send request\r\n  const handleSubmit = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      const res = await fetch(`${baseUrl}/api/Requests`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: token ? `Bearer ${token}` : \"\",\r\n        },\r\n        body: JSON.stringify({\r\n          workerId: Number(id),\r\n          projectId,\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) throw new Error(\"فشل في إرسال الطلب\");\r\n\r\n      const data = await res.json();\r\n      setResponse(data);\r\n    } catch (err: any) {\r\n      setError(err.message || \"حدث خطأ غير متوقع\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-xl mx-auto\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">إرسال طلب لعامل</h1>\r\n\r\n      <div className=\"space-y-4\">\r\n        <div>\r\n          <label className=\"block font-semibold mb-1\">Worker ID:</label>\r\n          <input\r\n            type=\"number\"\r\n            value={id}\r\n            disabled\r\n            className=\"border rounded p-2 w-full bg-gray-100 text-gray-600\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block font-semibold mb-1\">اختر مشروعًا:</label>\r\n          <select\r\n            className=\"border rounded p-2 w-full\"\r\n            value={projectId}\r\n            onChange={(e) => setProjectId(Number(e.target.value))}\r\n            disabled={projects.length === 0}\r\n          >\r\n            <option value={0}>-- اختر مشروعًا --</option>\r\n            {projects.map((project) => (\r\n              <option key={project.id} value={project.id}>\r\n                {project.name} - {project.apartmentType}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          {projects.length === 0 && (\r\n            <div className=\"mt-2 text-blue-600 flex items-center gap-2\">\r\n              no projects available.\r\n              <a\r\n                href=\"/startProject\"\r\n                className=\"inline-flex items-center px-2 py-1 bg-blue-100 rounded hover:bg-blue-200 text-blue-700 text-sm font-semibold\"\r\n              >\r\n                + add new project\r\n              </a>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <button\r\n          onClick={handleSubmit}\r\n          className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\r\n          disabled={loading || projectId === 0}\r\n        >\r\n          {loading ? <i className=\"fa fa-spinner fa-spin\"></i> : \"Send Request\"}\r\n        </button>\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"mt-4 text-red-600 font-semibold\">خطأ: {error}</div>\r\n      )}\r\n\r\n      {response && (\r\n        <div className=\"mt-6 p-4 border rounded bg-gray-100\">\r\n          <h2 className=\"font-bold mb-2\">Sent Successfully</h2>\r\n          \r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 266, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}},
    {"offset": {"line": 267, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}