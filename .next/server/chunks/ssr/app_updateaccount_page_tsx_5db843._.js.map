{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/app/updateaccount/page.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useLoginClient } from \"../context/regester/login_context\";\r\nimport axios from \"axios\";\r\n\r\nfunction ProfileModal({ onClose }) {\r\n  const { updateAccountInfo } = useLoginClient();\r\n  const [step, setStep] = useState(1);\r\n\r\n  const [name, setName] = useState(\"\");\r\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n  const [address, setAddress] = useState(\"\");\r\n  const [buildingNumber, setBuildingNumber] = useState(\"\");\r\n  const [cityId, setCityId] = useState(\"\");\r\n  const [age, setAge] = useState(0);\r\n  const [description, setDescription] = useState(\"\");\r\n  const [companyName, setCompanyName] = useState(\"\");\r\n  const [experienceYears, setExperienceYears] = useState(0);\r\n  const [serviceId, setServiceId] = useState(\"\");\r\n\r\n  const [cities, setCities] = useState([]);\r\n  const [services, setServices] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const data = localStorage.getItem(\"userData\");\r\n    if (data) {\r\n      const user = JSON.parse(data);\r\n      setName(user.displayName || \"\");\r\n      setPhoneNumber(user.phoneNumber || \"\");\r\n      setAddress(user.address || \"\");\r\n      setBuildingNumber(user.buildingNumber || \"\");\r\n      setCityId(user.cityId?.toString() || \"\");\r\n      setAge(user.age || 0);\r\n      setDescription(user.description || \"\");\r\n      setCompanyName(user.companyName || \"\");\r\n      setExperienceYears(user.experienceYears || 0);\r\n      setServiceId(user.serviceId?.toString() || \"\");\r\n    }\r\n\r\n    const fetchData = async () => {\r\n      try {\r\n        const [citiesRes, servicesRes] = await Promise.all([\r\n          axios.get(\"https://projectapi-ekhpcndsdgbahqhm.canadacentral-01.azurewebsites.net/api/Cities\"),\r\n          axios.get(\"https://projectapi-ekhpcndsdgbahqhm.canadacentral-01.azurewebsites.net/api/categories/services?pageSize=1000\")\r\n        ]);\r\n\r\n        const citiesData = citiesRes.data?.data || citiesRes.data || [];\r\n        setCities(Array.isArray(citiesData) ? citiesData : []);\r\n\r\n        const servicesRaw = servicesRes.data?.data || servicesRes.data || [];\r\n        const validServices = Array.isArray(servicesRaw)\r\n          ? servicesRaw.filter((service) => service?.id && service?.name)\r\n          : [];\r\n        setServices(validServices);\r\n      } catch (err) {\r\n        console.error(\"❌ Failed to fetch data:\", err);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  const handleSave = async () => {\r\n    try {\r\n      await updateAccountInfo({\r\n        name,\r\n        phoneNumber,\r\n        address,\r\n        buildingNumber,\r\n        cityId: Number(cityId),\r\n        age: Number(age),\r\n        description,\r\n        companyName,\r\n        experienceYears: Number(experienceYears),\r\n        serviceId: Number(serviceId),\r\n      });\r\n\r\n      alert(\"تم التحديث بنجاح\");\r\n      if (typeof onClose === \"function\") onClose(); // ✅ تجنب الخطأ\r\n    } catch (err) {\r\n      alert(\"فشل التحديث: \" + err.message);\r\n      setStep(1); // ✅ رجوع للصفحة الأولى عند الخطأ\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={modalBackdropStyle}>\r\n      <div style={modalContainerStyle}>\r\n        <Link href=\"/account\"><button onClick={onClose} style={closeBtnStyle}>&#10005;</button></Link>\r\n        <h3 style={{ fontWeight: 600, fontSize: 20, marginBottom: 12 }}>\r\n          Edit Profile Info ({step}/2)\r\n        </h3>\r\n\r\n        {step === 1 && (\r\n          <>\r\n            <label>Name</label>\r\n            <input value={name} onChange={(e) => setName(e.target.value)} style={inputStyle} />\r\n\r\n            <label>Phone Number</label>\r\n            <input value={phoneNumber} onChange={(e) => setPhoneNumber(e.target.value)} style={inputStyle} />\r\n\r\n            <label>Age</label>\r\n            <input type=\"number\" value={age} onChange={(e) => setAge(e.target.value)} style={inputStyle} />\r\n\r\n            <label>City</label>\r\n            <select value={cityId} onChange={(e) => setCityId(e.target.value)} style={inputStyle}>\r\n              <option value=\"\">اختر المدينة</option>\r\n              {cities.map((city) => (\r\n                <option key={city.id} value={city.id}>\r\n                  {city.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n\r\n            <label>Address</label>\r\n            <input value={address} onChange={(e) => setAddress(e.target.value)} style={inputStyle} />\r\n\r\n            <label>Building Number</label>\r\n            <input value={buildingNumber} onChange={(e) => setBuildingNumber(e.target.value)} style={inputStyle} />\r\n\r\n            <button style={saveBtnStyle} onClick={() => setStep(2)}>التالي</button>\r\n          </>\r\n        )}\r\n\r\n        {step === 2 && (\r\n          <>\r\n            <label>Company Name</label>\r\n            <input value={companyName} onChange={(e) => setCompanyName(e.target.value)} style={inputStyle} />\r\n\r\n            <label>Experience Years</label>\r\n            <input type=\"number\" value={experienceYears} onChange={(e) => setExperienceYears(e.target.value)} style={inputStyle} />\r\n\r\n            <label>Description</label>\r\n            <input value={description} onChange={(e) => setDescription(e.target.value)} style={inputStyle} />\r\n\r\n            <label>Service</label>\r\n            <select value={serviceId} onChange={(e) => setServiceId(e.target.value)} style={inputStyle}>\r\n              <option value=\"\">اختر الخدمة</option>\r\n              {services.map((service) => (\r\n                <option key={service.id} value={service.id}>\r\n                  {service.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n\r\n            <div style={{ display: \"flex\", gap: \"8px\", marginTop: \"10px\" }}>\r\n              <button onClick={() => setStep(1)} style={{ ...saveBtnStyle, backgroundColor: \"#aaa\" }}>السابق</button>\r\n              <button style={saveBtnStyle} onClick={handleSave}>حفظ</button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst modalBackdropStyle = {\r\n  position: \"fixed\",\r\n  top: 0,\r\n  left: 0,\r\n  width: \"100%\",\r\n  height: \"100%\",\r\n  backgroundColor: \"rgba(0,0,0,0.5)\",\r\n  display: \"flex\",\r\n  justifyContent: \"center\",\r\n  alignItems: \"center\",\r\n  zIndex: 1000,\r\n};\r\n\r\nconst modalContainerStyle = {\r\n  backgroundColor: \"#fff\",\r\n  padding: \"20px\",\r\n  borderRadius: \"8px\",\r\n  width: \"400px\",\r\n  boxShadow: \"0 2px 10px rgba(0,0,0,0.1)\",\r\n  position: \"relative\",\r\n};\r\n\r\nconst closeBtnStyle = {\r\n  position: \"absolute\",\r\n  top: \"10px\",\r\n  right: \"10px\",\r\n  background: \"none\",\r\n  border: \"none\",\r\n  fontSize: \"24px\",\r\n  cursor: \"pointer\",\r\n};\r\n\r\nconst inputStyle = {\r\n  width: \"100%\",\r\n  padding: \"8px\",\r\n  margin: \"10px 0\",\r\n  borderRadius: \"4px\",\r\n  border: \"1px solid #ccc\",\r\n};\r\n\r\nconst saveBtnStyle = {\r\n  backgroundColor: \"#4CAF50\",\r\n  color: \"white\",\r\n  padding: \"10px 15px\",\r\n  border: \"none\",\r\n  borderRadius: \"4px\",\r\n  cursor: \"pointer\",\r\n  width: \"100%\",\r\n};\r\n\r\nexport default ProfileModal;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}