{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/app/portfolio-details/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { useLoginClient } from \"../../context/regester/login_context\";\r\nimport { useApi } from \"../../context/ApiContext\";\r\nimport { useToken } from \"../../context/token_context\";\r\nimport Image from \"next/image\";\r\n\r\nexport default function PortfolioDetailsPage() {\r\n  const { id } = useParams();\r\n  const router = useRouter();\r\n  const { token, saveData } = useLoginClient();\r\n  const { userData } = useToken();\r\n  const { baseUrl } = useApi();\r\n\r\n  const [portfolio, setPortfolio] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [editName, setEditName] = useState(\"\");\r\n  const [editDescription, setEditDescription] = useState(\"\");\r\n\r\n  const userRole =\r\n    userData?.[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"] || \"\";\r\n  const isOwnProfile = userRole === \"Worker\" && portfolio?.workerId === saveData?.workerId;\r\n\r\n  useEffect(() => {\r\n    if (!token || !id) return;\r\n\r\n    const fetchDetails = async () => {\r\n      try {\r\n        const res = await fetch(`${baseUrl}/api/Portfolio/${id}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n\r\n        if (!res.ok) throw new Error(\"ŸÅÿ¥ŸÑ ŸÅŸä ÿ¨ŸÑÿ® ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ®Ÿàÿ±ÿ™ŸÅŸàŸÑŸäŸà\");\r\n\r\n        const data = await res.json();\r\n        const imageUrls = Array.isArray(data.imageUrls)\r\n          ? data.imageUrls.map((url: any, index: number) =>\r\n              typeof url === \"string\" ? { id: index, imageUrl: url } : url\r\n            )\r\n          : [];\r\n\r\n        setPortfolio({ ...data, imageUrls });\r\n        setEditName(data.name);\r\n        setEditDescription(data.description);\r\n      } catch (err) {\r\n        console.error(\"‚ùå Error fetching portfolio details:\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchDetails();\r\n  }, [id, token]);\r\n\r\n  const handleDeleteImage = async (imageId: number) => {\r\n    if (!confirm(\"ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ Ÿáÿ∞Ÿá ÿßŸÑÿµŸàÿ±ÿ©ÿü\")) return;\r\n\r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/Portfolio/${id}/images/${imageId}`, {\r\n        method: \"DELETE\",\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n\r\n      if (!res.ok) throw new Error(\"ŸÅÿ¥ŸÑ ŸÅŸä ÿ≠ÿ∞ŸÅ ÿßŸÑÿµŸàÿ±ÿ©\");\r\n\r\n      setPortfolio((prev: any) => ({\r\n        ...prev,\r\n        imageUrls: prev.imageUrls.filter((img: any) => img.id !== imageId),\r\n      }));\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error deleting image:\", err);\r\n    }\r\n  };\r\n\r\n const handleSaveChanges = async () => {\r\n  try {\r\n    const res = await fetch(`${baseUrl}/api/Portfolio/${id}`, {\r\n      method: \"PUT\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n      body: JSON.stringify({\r\n        name: editName,\r\n        description: editDescription,\r\n      }),\r\n    });\r\n\r\n    if (!res.ok) {\r\n      const errorText = await res.text();\r\n      console.error(\"‚ùå ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿÆÿ∑ÿ£:\", errorText);\r\n      throw new Error(\"ŸÅÿ¥ŸÑ ŸÅŸä ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿπÿØŸäŸÑÿßÿ™\");\r\n    }\r\n\r\n    setPortfolio((prev: any) => ({\r\n      ...prev,\r\n      name: editName,\r\n      description: editDescription,\r\n    }));\r\n\r\n    alert(\"‚úÖ ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠\");\r\n  } catch (err) {\r\n    console.error(\"‚ùå Error updating portfolio:\", err);\r\n  }\r\n};\r\n\r\n\r\n  if (loading) return <div className=\"p-4\">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...</div>;\r\n  if (!portfolio) return <div className=\"p-4 text-red-600\">ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑÿ®Ÿàÿ±ÿ™ŸÅŸàŸÑŸäŸà</div>;\r\n\r\n  return (\r\n    <div className=\"p-4 bg-white min-h-screen\">\r\n      {isOwnProfile ? (\r\n        <>\r\n          <input\r\n            type=\"text\"\r\n            value={editName}\r\n            onChange={(e) => setEditName(e.target.value)}\r\n            className=\"text-xl font-bold mb-2 text-green-700 border p-2 w-full rounded\"\r\n            placeholder=\"ÿßÿ≥ŸÖ ÿßŸÑÿ®Ÿàÿ±ÿ™ŸÅŸàŸÑŸäŸà\"\r\n          />\r\n          <textarea\r\n            value={editDescription}\r\n            onChange={(e) => setEditDescription(e.target.value)}\r\n            className=\"mb-4 w-full border p-2 rounded text-gray-600\"\r\n            placeholder=\"ÿßŸÑŸàÿµŸÅ\"\r\n          />\r\n        </>\r\n      ) : (\r\n        <>\r\n          <h1 className=\"text-xl font-bold mb-4 text-green-700\">{portfolio.name}</h1>\r\n          <p className=\"mb-4 text-gray-600\">{portfolio.description}</p>\r\n        </>\r\n      )}\r\n\r\n      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2 mb-6\">\r\n        {portfolio.imageUrls?.map((img: any) => (\r\n          <div key={img.id} className=\"relative group\">\r\n            <Image\r\n              src={img.imageUrl}\r\n              alt=\"portfolio image\"\r\n              width={200}\r\n              height={200}\r\n              className=\"rounded object-cover w-full h-32\"\r\n            />\r\n            {isOwnProfile && (\r\n              <button\r\n                onClick={() => handleDeleteImage(img.id)}\r\n                className=\"absolute top-1 right-1 bg-white text-red-600 rounded-full p-1 text-xs opacity-0 group-hover:opacity-100 transition\"\r\n                title=\"ÿ≠ÿ∞ŸÅ ÿßŸÑÿµŸàÿ±ÿ©\"\r\n              >\r\n                üóëÔ∏è\r\n              </button>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {isOwnProfile && (\r\n        <div className=\"flex flex-wrap gap-2 mb-6\">\r\n          <button\r\n            onClick={handleSaveChanges}\r\n            className=\"bg-green-600 text-white px-4 py-2 rounded\"\r\n          >\r\n            üíæ ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿπÿØŸäŸÑÿßÿ™\r\n          </button>\r\n          <button\r\n            onClick={() => router.push(`/add-portfolio-images/${id}`)}\r\n            className=\"bg-gray-600 text-white px-4 py-2 rounded\"\r\n          >\r\n            ‚ûï ÿ•ÿ∂ÿßŸÅÿ© ÿµŸàÿ±\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      <div>\r\n        <button\r\n          onClick={() => router.back()}\r\n          className=\"bg-gray-300 px-4 py-2 rounded hover:bg-gray-400\"\r\n        >\r\n          ÿßŸÑÿ±ÿ¨Ÿàÿπ\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 288, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}