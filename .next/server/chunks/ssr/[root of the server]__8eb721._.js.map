{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file://D%3A/front_end/projects/next_js/smart-finshing/app/portfolio/page.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Image from \"next/image\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { useLoginClient } from \"../context/regester/login_context\";\r\nimport { useApi } from \"../context/ApiContext\";\r\nimport { useToken } from \"../context/token_context\";\r\n\r\nexport default function AllPortfolioPage() {\r\n  const { token, saveData } = useLoginClient();\r\n  const router = useRouter();\r\n  const params = useParams();\r\n  const id = params?.id as string; // üëà Ÿáÿ∞ÿß ŸáŸà ŸÖÿπÿ±ŸÅ ÿßŸÑÿπÿßŸÖŸÑ ÿßŸÑÿ∞Ÿä ŸÜÿπÿ±ÿ∂ ÿ®ÿ±ŸàŸÅÿßŸäŸÑŸá\r\n  const [portfolios, setPortfolios] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const { baseUrl } = useApi();\r\n  const { userData } = useToken();\r\n\r\n  const userRole =\r\n    userData?.[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"] || \"\";\r\n\r\n  const isOwnProfile = userRole === \"Worker\" && String(saveData?.workerId) === id;\r\n\r\n  useEffect(() => {\r\n    if (!token || !id) return;\r\n\r\n    const fetchPortfolios = async () => {\r\n      try {\r\n        const res = await fetch(`${baseUrl}/api/Portfolio/${id}`, {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            Accept: \"application/json\",\r\n          },\r\n        });\r\n\r\n        if (!res.ok) throw new Error(\"ŸÅÿ¥ŸÑ ŸÅŸä ÿ¨ŸÑÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™\");\r\n\r\n        const data = await res.json();\r\n        setPortfolios(data);\r\n      } catch (err) {\r\n        console.error(\"‚ùå Error fetching portfolio:\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchPortfolios();\r\n  }, [token, id]);\r\n\r\n  const handleDelete = async (portfolioId: number) => {\r\n    if (!confirm(\"ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ÿ£ŸÜŸÉ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ®Ÿàÿ±ÿ™ŸÅŸàŸÑŸäŸàÿü\")) return;\r\n\r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/Portfolio/${portfolioId}`, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          Accept: \"application/json\",\r\n        },\r\n      });\r\n\r\n      if (!res.ok) throw new Error(\"ŸÅÿ¥ŸÑ ŸÅŸä ÿ≠ÿ∞ŸÅ ÿßŸÑÿ®Ÿàÿ±ÿ™ŸÅŸàŸÑŸäŸà\");\r\n\r\n      setPortfolios((prev) => prev.filter((item) => item.id !== portfolioId));\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error deleting portfolio:\", err);\r\n    }\r\n  };\r\n\r\n  const handleDeleteImage = async (portfolioId: number, imageId: number) => {\r\n    if (!confirm(\"ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ Ÿáÿ∞Ÿá ÿßŸÑÿµŸàÿ±ÿ©ÿü\")) return;\r\n\r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/Portfolio/${portfolioId}/images/${imageId}`, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          Accept: \"application/json\",\r\n        },\r\n      });\r\n\r\n      if (!res.ok) throw new Error(\"ŸÅÿ¥ŸÑ ŸÅŸä ÿ≠ÿ∞ŸÅ ÿßŸÑÿµŸàÿ±ÿ©\");\r\n\r\n      setPortfolios((prev) =>\r\n        prev.map((portfolio) =>\r\n          portfolio.id === portfolioId\r\n            ? {\r\n                ...portfolio,\r\n                imageUrls: portfolio.imageUrls.filter((img) => img.id !== imageId),\r\n              }\r\n            : portfolio\r\n        )\r\n      );\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error deleting image:\", err);\r\n    }\r\n  };\r\n\r\n  const handleEdit = (id: number) => {\r\n    router.push(`/edit-portfolio/${id}`);\r\n  };\r\n\r\n  const handleAddImages = (id: number) => {\r\n    router.push(`/add-portfolio-images/${id}`);\r\n  };\r\n\r\n  if (loading) return <div className=\"p-4\">Loading...</div>;\r\n\r\n  return (\r\n    <div className=\"p-4 bg-white min-h-screen\">\r\n      <h1 className=\"text-2xl font-bold mb-6 text-center text-green-700\">\r\n        ÿ¨ŸÖŸäÿπ ÿπŸÜÿßÿµÿ± ÿßŸÑÿ®Ÿàÿ±ÿ™ŸÅŸàŸÑŸäŸà\r\n      </h1>\r\n\r\n      {isOwnProfile && (\r\n        <div className=\"text-right mb-4\">\r\n          <button\r\n            onClick={() => router.push(\"/AddPortfolio\")}\r\n            className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 text-sm\"\r\n          >\r\n            ‚ûï ÿ•ÿ∂ÿßŸÅÿ© ÿ®Ÿàÿ±ÿ™ŸÅŸàŸÑŸäŸà\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {portfolios.length === 0 ? (\r\n        <p className=\"text-center text-gray-500\">ŸÑÿß ŸäŸàÿ¨ÿØ ÿπŸÜÿßÿµÿ± ŸÑÿπÿ±ÿ∂Ÿáÿß.</p>\r\n      ) : (\r\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n          {portfolios.map((item) => (\r\n            <div key={item.id} className=\"border rounded-lg p-2 shadow relative\">\r\n              <div className=\"flex justify-between items-center mb-1\">\r\n                <h2 className=\"font-semibold text-sm text-green-800 truncate\">\r\n                  {item.name}\r\n                </h2>\r\n                {isOwnProfile && (\r\n                  <div className=\"flex gap-2\">\r\n                    <button\r\n                      onClick={() => handleEdit(item.id)}\r\n                      className=\"text-blue-600 hover:text-blue-800 text-xs\"\r\n                      title=\"ÿ™ÿπÿØŸäŸÑ\"\r\n                    >\r\n                      ‚úèÔ∏è\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleDelete(item.id)}\r\n                      className=\"text-red-500 hover:text-red-700 text-xs\"\r\n                      title=\"ÿ≠ÿ∞ŸÅ\"\r\n                    >\r\n                      üóëÔ∏è\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <p className=\"text-xs text-gray-600 mb-2 truncate\">{item.description}</p>\r\n\r\n              <div className=\"grid grid-cols-2 gap-1 mb-2\">\r\n                {item.imageUrls.map((img) => (\r\n                  <div key={img.id} className=\"relative group\">\r\n                    <Image\r\n                      src={img.imageUrl}\r\n                      alt=\"portfolio image\"\r\n                      width={100}\r\n                      height={100}\r\n                      className=\"rounded object-cover w-full h-24\"\r\n                    />\r\n                    {isOwnProfile && (\r\n                      <button\r\n                        onClick={() => handleDeleteImage(item.id, img.id)}\r\n                        className=\"absolute top-1 right-1 bg-white text-red-600 rounded-full p-1 text-xs opacity-0 group-hover:opacity-100 transition\"\r\n                        title=\"ÿ≠ÿ∞ŸÅ ÿßŸÑÿµŸàÿ±ÿ©\"\r\n                      >\r\n                        üóëÔ∏è\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {isOwnProfile && (\r\n                <button\r\n                  onClick={() => handleAddImages(item.id)}\r\n                  className=\"w-full bg-gray-100 hover:bg-gray-200 text-xs py-1 rounded text-gray-700\"\r\n                >\r\n                  ‚ûï ÿ•ÿ∂ÿßŸÅÿ© ÿµŸàÿ±\r\n                </button>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"mt-6 text-center\">\r\n        <button\r\n          onClick={() => router.back()}\r\n          className=\"bg-gray-300 px-4 py-2 rounded hover:bg-gray-400 text-sm\"\r\n        >\r\n          ÿßŸÑÿ±ÿ¨Ÿàÿπ\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 306, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}